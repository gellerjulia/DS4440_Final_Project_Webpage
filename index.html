<!doctype html>
<html lang="en">
<head>
<title>Brain Image Classifier</title>
<meta property="og:title" content=Your Project Name" />
<meta name="twitter:title" content="Your Project Name" />
<meta name="description" content="Your project about your cool topic described right here." />
<meta property="og:description" content="Your project about your cool topic described right here." />
<meta name="twitter:description" content="Your project about your cool topic described right here." />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- bootstrap for mobile-friendly layout -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
<link href="style.css" rel="stylesheet">

</head>
<body class="nd-docs">
<div class="nd-pageheader">
 <div class="container">
 <h1 class="lead">
 <nobr class="widenobr">Brain Image Classifier</nobr>
 <nobr class="widenobr">For CS 4440</nobr>
 </h1>
 </div>
</div><!-- end nd-pageheader -->

<div class="container">
<div class="row">
<div class="col justify-content-center text-center">
<h2>Extending &quot;Brain Tumor Classification Using Convolutional Neural Network &quot;</h2>
</div>
</div>
<div class="row">
<div class="col">

<h2>Introduction</h2>

<p>The goal of our project is to create a Neural Network that can classify if an MRI brain image was either healthy, contained a glioma tumor, contained a meningioma tumor, or contained a pituitary tumor. We based our approach off of the publication &quot;Brain Tumor Classification Using Convolutional Neural Network&quot; by Abiwinanda et. al. The publication we used successfully built a model that classified tumor images as one of the three aforementioned tumors, but we wanted to extend the capabilities to also distinguish between tumor and healthy brain scans so the model could fulfill a wider array of physician needs. 
</p>



<h2>About the Data</h2>

<p>The data used in this project is a combination of two datasets, referred to as <a href="https://figshare.com/articles/dataset/brain_tumor_dataset/1512427/5"
  >fig share</a> and  <a href="https://www.kaggle.com/datasets/sartajbhuvaji/brain-tumor-classification-mri"
  >SARTAJ</a>. Fig share is the data used in the original paper. This data includes T1-weighted MRI brain images for patients with one of three types of tumors: glioma, meningioma, and pituitary. SARTAJ is a Kaggle dataset with MRI brain images of patients with one of the aforementioned tumor types and healthy patients. In our project, we only use the brain images of healthy patients from this dataset. Both datasets had grayscale images. Fig share images were mainly sized 512x512 while SARTAJ images were mainly size 233x236, though there was variation in each dataset. All images were resized to 64x64 and 128x128 images. The varying sizes were tested in an attempt to achieve increased model performance, however, models trained on the 128x128 sized images had worse accuracy so we only trained models on images resized to be 64x64 pixels. </p>

<p> We tested the models on balanced and an imbalanced splits of train, test, and validation data where the imbalanced set had more train images for the glioma class as we noticed this calss had the msot incorrect predictions. We found that the imbalanced dataset improved accuracy so wwe tested all models on the imbalanced dataset. This dataset consists of 500 train, 100 validation, and 100 test images for each non-glioma tumor and 219 train, 50 validation, and 50 test images for the healthy class. A smaller validation and test set was used for the healthy class as this class consisted of fewer images and we wanted to retain as many images as possible for training. The glioma class had 836 train, 50 validation, and 50 test images. 
</p>



<h2>Models</h2>

<p> We compared the original model to an adjsuted  model we created.
</p>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two Tables Side by Side</title>
<style>
.table-container {
  display: flex;
}

.table-container .table {
  margin-right: 20px; /* Adjust spacing between tables */
}
</style>
</head>
<body>

<div class="table-container">
  <div class="table">
    <h2>Adjusted Model Architecture</h2>
    <table border="1">
   <tr>
     <th>Layer (type)</th>
     <th>Output Shape</th>
     <th>Param #</th>
     <th>Activation</th>
   </tr>
   <tr>
     <td>Input</td>
     <td>(-1, 1, 64, 64)</td>
     <td></td>
     <td></td>
   </tr>
   <tr>
     <td>Conv2d</td>
     <td>(-1, 16, 64, 64)</td>
     <td>160</td>
     <td></td>
   </tr>
   <tr>
     <td>MaxPool2d</td>
     <td>(-1, 16, 32, 32)</td>
     <td></td>
     <td>ReLU</td>
   </tr>
   <tr>
     <td>Conv2d</td>
     <td>(-1, 16, 32, 32)</td>
     <td>4,640</td>
     <td></td>
   </tr>
   <tr>
     <td>MaxPool2d</td>
     <td>(-1, 32, 16, 16)</td>
     <td></td>
     <td>ReLU</td>
   </tr>
   <tr>
     <td>Conv2d</td>
     <td>(-1, 64, 16, 16)</td>
     <td>18,496</td>
     <td></td>
   </tr>
   <tr>
     <td>MaxPool2d</td>
     <td>(-1, 64, 8, 8)</td>
     <td></td>
     <td>ReLU</td>
   </tr>
 
   <tr>
     <td>Linear</td>
     <td>(-1, 128)</td>
     <td>524,416</td>
     <td>ReLU</td>
   </tr>
   <tr>
     <td>Linear</td>
     <td>(-1, 4)</td>
     <td>516</td>
     <td></td>
   </tr>
   <tr>
     <td>Total Parameters:</td>
     <td></td>
     <td>548,228</td>
     <td></td>
   </tr>
    </table>
  </div>
  
  <div class="table">
    <h2>Original Model Architecture</h2>
    <table border="1">
        <tr>
          <th>Layer (type)</th>
          <th>Output Shape</th>
          <th>Param #</th>
          <th>Activation</th>
        </tr>
        <tr>
          <td>Input</td>
          <td>(-1, 1, 64, 64)</td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td>Conv2d</td>
          <td>(-1, 32, 62, 32)</td>
          <td>320</td>
          <td>ReLU</td>
        </tr>
        <tr>
          <td>MaxPool2d</td>
          <td>(-1, 32, 31, 31)</td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td>Conv2d</td>
          <td>(-1, 32, 29, 29)</td>
          <td>9,248</td>
          <td>ReLU</td>
        </tr>
        <tr>
          <td>MaxPool2d</td>
          <td>(-1, 32, 14, 14)</td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td>Linear</td>
          <td>(-1, 64)</td>
          <td>401,472</td>
          <td>ReLU</td>
        </tr>
        <tr>
          <td>Linear</td>
          <td>(-1, 4)</td>
          <td>260</td>
          <td></td>
        </tr>
        <tr>
          <td>Softmax</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td>Total Parameters:</td>
          <td></td>
          <td>411,300</td>
          <td></td>
        </tr>
    </table>
  </div>
</div>

</body>
</html>



<h3>Training</h3>

<p> All models were trained using Cross Entropy Loss and the Adam optimizer. The adjusted models were trained for 15 epochs with a learning rate of 0.001 while the original paper models were trained for 10 epochs with a learning rate of 0.001 as was specified in the original paper.
</p>



<h3>Results</h3>


<div class="row">
  <div class="column">

    <h5>Adjusted Model</h5>

    <p>Test Loss: 0.5363, Test Accuracy: 80.33%
    </p>

    <p>Figure 1: Confusion Matrix for Adjusted Model</p>

    <img src="graphs/adjusted_matrix.png" width="500" height="500">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 2: Training and Validation Loss and Accuracy plots for Adjusted model</p>
    <img src="graphs/adjusted_train_loss_plot.png" width="550" height=270">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 3: Outputs of convolution 1 of Adjusted model</p>
    <img src="graphs/adjusted_1st_conv.png" width="500" height="500">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 3.1: Outputs of convolution 2 of Adjusted model</p>
    <img src="graphs/adjusted_2nd_conv.png" width="520" height="520">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 3.2: Outputs of convolution 3 of Adjusted model</p>
    <img src="graphs/adjusted_3rd_conv.png" width="550" height="550">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 4: Parameters Gradients of Adjusted model</p>
    <img src="graphs/adjusted_para_grad.png" width="500" height="312.5">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 5: Activations of Adjusted model</p>
    <img src="graphs/adjusted_act.png" width="500" height="312.5">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 6: Activations Parameters of Adjusted model</p>
    <img src="graphs/adjusted_act_grad.png" width="500" height="312.5">
  </div>

  <div class="column">
    
    <h5>Original Model</h5>

    <p>Test Loss: 1.13, Test Accuracy: 61%
    </p>

    <p>Figure 1.1: Confusion Matrix for Original model</p>

    <img src="graphs/original_matrix.png" width="500" height="500">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 2.1: Training and Validation Loss and Accuracy plots for Original Model trained on tumor and healthy data</p>
    <img src="graphs/original_train_loss.png" width="550" height="270">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 3.3: Outputs of convolution 1 of Original model</p>
    <img src="graphs/original_1st_conv.png" width="500" height="500">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 3.4: Outputs of convolution 2 of Original model</p>
    <img src="graphs/original_2nd_conv.png" width="520" height="520">

    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <br><br><br><br><br><br><br>

    <p>Figure 4.1: Parameters Gradients of Original model</p>
    <img src="graphs/original_para_grad.png" width="500" height="312.5">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 5.1: Activations of Original model</p>
    <img src="graphs/original_act.png" width="500" height="312.5">

    <br>
    <br>
    <br>
    <br>

    <p>Figure 6.1: Activations Parameters of Original model</p>
    <img src="graphs/original_act_grad.png" width="500" height="312.5">
  </div>
</div>


<!-- <ul> For each model
  Qi: Tumor + healthy
  Julia: Tumor only
  Qi: Class 1 and 2 tumor
  <li>Confusion matrices</li>
  <li>Julia: Accuracy, preciison, recall scors</li>
  <li>Julia: Show correct vs inccorect image predictions</li>
  <li>Qi: Show graphs with training and val loss</li>
  <li>Julia: See what is happening with weights and biases during learning (exploding, not learning, etc.)</li>
  <li>Qi: observing intermediate layer outputs</li>


</ul>

<p>TODO
</p> -->


<h3>References</h3>

<p><a name="abiwinanda-2018">[1]</a> <a href="https://link.springer.com/chapter/10.1007/978-981-10-9035-6_33"
  >Nyoman Abiwinanda et. al.
  <em>Brain Tumor Classification Using Convolutional Neural Network.</em></a>
  World Congress on Medical Physics and Biomedical Engineering 2018.
</p>

<h2>Team Members</h2>
                                                   
<p>Julia Geller, Qi Li</p>

  
</div><!--col-->
</div><!--row -->
</div> <!-- container -->

<footer class="nd-pagefooter">
  <div class="row">
    <div class="col-6 col-md text-center">
      <a href="https://cs4440.baulab.info/">About CS 4440</a>
    </div>
  </div>
</footer>

</body>
<script>
$(document).on('click', '.clickselect', function(ev) {
  var range = document.createRange();
  range.selectNodeContents(this);
  var sel = window.getSelection();
  sel.removeAllRanges();
  sel.addRange(range);
});
// Google analytics below.
window.dataLayer = window.dataLayer || [];
</script>
</html>
